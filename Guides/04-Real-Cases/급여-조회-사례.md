# ê¸‰ì—¬ ì¡°íšŒ ì‚¬ë¡€

## ì‚¬ë¡€ 1: íŠ¹ì • ì‹œì ì˜ ë³¸ë¶€ë³„/íŒ€ë³„/ì„ì›ë³„ ì¸ê±´ë¹„ ì¡°íšŒ

### ì—…ë¬´ ìš”êµ¬ì‚¬í•­

> "ê³¼ê±° íŠ¹ì • ì‹œì ì— ë³¸ë¶€ë³„/íŒ€ë³„/ì„ì›ë³„ ì¸ê±´ë¹„ í˜„í™© ì¡°íšŒê°€ í•„ìš”"
> (ì¶œì²˜: Requirements/ê¸‰ì—¬.md)

ì˜ˆì‚° ê³„íš, ë³´ê³ ì„œ ì‘ì„± ë“±ì„ ìœ„í•´ íŠ¹ì • ì‹œì (ì˜ˆ: 2023ë…„ 6ì›” 30ì¼)ì˜ ì¸ê±´ë¹„ í˜„í™©ì„ ì¡°íšŒí•´ì•¼ í•©ë‹ˆë‹¤.

### ê°€ìƒì˜ í…Œì´ë¸” êµ¬ì¡°

```sql
-- ì§ì› ê¸‰ì—¬ ì •ë³´
employee_salaries (
    emp_id INT,
    effective_date DATE,  -- ê¸‰ì—¬ ì ìš© ì‹œì‘ì¼
    base_salary DECIMAL,  -- ê¸°ë³¸ê¸‰
    bonus DECIMAL,        -- ìƒì—¬ê¸ˆ
    allowances DECIMAL    -- ìˆ˜ë‹¹
)

-- ì§ì› ì†Œì† ì´ë ¥
employee_assignments (
    assignment_id INT,
    emp_id INT,
    dept_id INT,
    team_id INT,
    position VARCHAR,
    start_date DATE,
    end_date DATE
)

-- ë¶€ì„œ/ë³¸ë¶€
departments (
    dept_id INT,
    dept_name VARCHAR,
    dept_type VARCHAR,  -- 'ë³¸ë¶€', 'íŒ€' ë“±
    parent_dept_id INT
)

-- ì„ì› ì •ë³´
executives (
    emp_id INT,
    executive_level VARCHAR,  -- 'C-Level', 'ì„ì›', 'ìƒë¬´' ë“±
    appointed_date DATE
)
```

### AIì—ê²Œ ì§ˆë¬¸í•˜ëŠ” ë²•

#### 1ë‹¨ê³„: íŠ¹ì • ì‹œì ì˜ ìœ íš¨í•œ ê¸‰ì—¬ ì¡°íšŒ

```
## ëª©í‘œ
2023ë…„ 6ì›” 30ì¼ ì‹œì ì— ìœ íš¨í–ˆë˜ ê° ì§ì›ì˜ ê¸‰ì—¬ë¥¼ ì¡°íšŒí•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.

## í…Œì´ë¸” êµ¬ì¡°
- employee_salaries:
  - emp_id: ì§ì› ID
  - effective_date: ê¸‰ì—¬ ì ìš© ì‹œì‘ì¼
  - base_salary: ê¸°ë³¸ê¸‰
  - bonus: ìƒì—¬ê¸ˆ
  - allowances: ìˆ˜ë‹¹

## ì¡°ê±´
- 2023ë…„ 6ì›” 30ì¼ ê¸°ì¤€
- ê° ì§ì›ì˜ ê°€ì¥ ìµœê·¼ì— ì ìš©ëœ ê¸‰ì—¬ ì •ë³´
- ì›” ì¸ê±´ë¹„ = base_salary + (bonus/12) + allowances

íŠ¹ì • ì‹œì ì˜ ê¸‰ì—¬ë¥¼ ì¡°íšŒí•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?
effective_dateê°€ í•´ë‹¹ ë‚ ì§œ ì´ì „ ì¤‘ ê°€ì¥ ìµœê·¼ ê²ƒì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.
```

#### ì˜ˆìƒ SQL

```sql
WITH target_date AS (
    SELECT DATE '2023-06-30' AS ref_date
),
latest_salaries AS (
    SELECT
        es.emp_id,
        es.base_salary,
        es.bonus,
        es.allowances,
        ROW_NUMBER() OVER (
            PARTITION BY es.emp_id
            ORDER BY es.effective_date DESC
        ) as rn
    FROM employee_salaries es
    CROSS JOIN target_date td
    WHERE es.effective_date <= td.ref_date
)
SELECT
    emp_id,
    base_salary AS ê¸°ë³¸ê¸‰,
    bonus AS ìƒì—¬ê¸ˆ,
    allowances AS ìˆ˜ë‹¹,
    base_salary + (bonus / 12.0) + allowances AS ì›”ì¸ê±´ë¹„
FROM latest_salaries
WHERE rn = 1;
```

#### 2ë‹¨ê³„: ë³¸ë¶€ë³„ ì§‘ê³„ ì¶”ê°€

```
ì¢‹ìŠµë‹ˆë‹¤! ì´ì œ ì´ ì •ë³´ë¥¼ ë³¸ë¶€ë³„ë¡œ ì§‘ê³„í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.

## ì¶”ê°€ í…Œì´ë¸”
- employee_assignments:
  - emp_id, dept_id, team_id, start_date, end_date
- departments:
  - dept_id, dept_name, dept_type, parent_dept_id

## ìš”êµ¬ì‚¬í•­
- 2023ë…„ 6ì›” 30ì¼ ì‹œì ì— ìœ íš¨í–ˆë˜ ì†Œì† ì •ë³´
- ë³¸ë¶€ë³„ ì¸ì› ìˆ˜ì™€ ì´ ì¸ê±´ë¹„
- íŒ€ë³„ë¡œë„ ì„¸ë¶„í™”

ìœ„ ê¸‰ì—¬ ì¿¼ë¦¬ì— JOINì„ ì¶”ê°€í•´ì£¼ì„¸ìš”.
```

#### ì˜ˆìƒ SQL

```sql
WITH target_date AS (
    SELECT DATE '2023-06-30' AS ref_date
),
latest_salaries AS (
    SELECT
        es.emp_id,
        es.base_salary + (es.bonus / 12.0) + es.allowances AS monthly_cost,
        ROW_NUMBER() OVER (
            PARTITION BY es.emp_id
            ORDER BY es.effective_date DESC
        ) as rn
    FROM employee_salaries es
    CROSS JOIN target_date td
    WHERE es.effective_date <= td.ref_date
),
active_assignments AS (
    SELECT
        ea.emp_id,
        ea.dept_id,
        ea.team_id
    FROM employee_assignments ea
    CROSS JOIN target_date td
    WHERE ea.start_date <= td.ref_date
      AND (ea.end_date IS NULL OR ea.end_date >= td.ref_date)
)
SELECT
    hq.dept_name AS ë³¸ë¶€,
    dept.dept_name AS íŒ€,
    COUNT(DISTINCT ls.emp_id) AS ì¸ì›ìˆ˜,
    SUM(ls.monthly_cost) AS ì›”ì¸ê±´ë¹„ì´ì•¡,
    AVG(ls.monthly_cost) AS í‰ê· ì¸ê±´ë¹„
FROM latest_salaries ls
INNER JOIN active_assignments aa ON ls.emp_id = aa.emp_id
LEFT JOIN departments dept ON aa.dept_id = dept.dept_id
LEFT JOIN departments hq ON dept.parent_dept_id = hq.dept_id
WHERE ls.rn = 1
GROUP BY ROLLUP(hq.dept_name, dept.dept_name)
ORDER BY hq.dept_name, dept.dept_name;
```

#### 3ë‹¨ê³„: ì„ì›ë³„ ì¸ê±´ë¹„ ì¶”ê°€

```
ì™„ë²½í•©ë‹ˆë‹¤! ë§ˆì§€ë§‰ìœ¼ë¡œ ì„ì›ì§„ì˜ ì¸ê±´ë¹„ë¥¼ ë³„ë„ë¡œ ì¡°íšŒí•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.

## ì¶”ê°€ í…Œì´ë¸”
- executives:
  - emp_id, executive_level, appointed_date

## ìš”êµ¬ì‚¬í•­
- 2023ë…„ 6ì›” 30ì¼ ì‹œì ì˜ í˜„ì§ ì„ì›
- ì„ì› ë“±ê¸‰ë³„ ì¸ê±´ë¹„ í†µê³„
- ì´ë¦„ê³¼ ì§ê¸‰ í¬í•¨

ì„ì› ì •ë³´ë¥¼ í¬í•¨í•œ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.
```

#### ì˜ˆìƒ SQL

```sql
WITH target_date AS (
    SELECT DATE '2023-06-30' AS ref_date
),
latest_salaries AS (
    -- (ì´ì „ê³¼ ë™ì¼)
    ...
)
SELECT
    e.executive_level AS ì„ì›ë“±ê¸‰,
    emp.emp_name AS ì´ë¦„,
    dept.dept_name AS ì†Œì†ë³¸ë¶€,
    ls.monthly_cost AS ì›”ì¸ê±´ë¹„
FROM executives e
INNER JOIN employees emp ON e.emp_id = emp.emp_id
INNER JOIN latest_salaries ls ON e.emp_id = ls.emp_id AND ls.rn = 1
LEFT JOIN active_assignments aa ON e.emp_id = aa.emp_id
LEFT JOIN departments dept ON aa.dept_id = dept.dept_id
CROSS JOIN target_date td
WHERE e.appointed_date <= td.ref_date
  AND emp.resign_date IS NULL  -- ì¬ì§ ì¤‘
ORDER BY e.executive_level, emp.emp_name;
```

---

## ì‚¬ë¡€ 2: ì›”ë³„ í”„ë¡œì íŠ¸ PL ë¦¬ìŠ¤íŠ¸

### ì—…ë¬´ ìš”êµ¬ì‚¬í•­

> "í•´ë‹¹ ì›”ì— í”„ë¡œì íŠ¸ì˜ PL list"
> (ì¶œì²˜: Requirements/ê¸‰ì—¬.md)

íŠ¹ì • ì›”ì— ì§„í–‰ëœ í”„ë¡œì íŠ¸ë“¤ì˜ PL(Project Leader) ëª©ë¡ê³¼ ê·¸ë“¤ì˜ ê¸‰ì—¬ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

### AIì—ê²Œ ì§ˆë¬¸í•˜ê¸°

```
## ëª©í‘œ
2023ë…„ 9ì›”ì— ì§„í–‰ ì¤‘ì´ì—ˆë˜ í”„ë¡œì íŠ¸ì˜ PL ëª©ë¡ê³¼
ê° PLì˜ í•´ë‹¹ ì›” ê¸‰ì—¬ë¥¼ ì¡°íšŒí•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.

## í…Œì´ë¸”
- projects: project_id, project_name, start_date, end_date
- project_assignments: project_id, emp_id, role, assigned_date, released_date
- employees: emp_id, emp_name, position
- employee_salaries: emp_id, effective_date, base_salary, bonus, allowances

## ì¡°ê±´
- 2023ë…„ 9ì›” ì¤‘ í•˜ë£¨ë¼ë„ ì§„í–‰ëœ í”„ë¡œì íŠ¸
- role = 'PL'ì¸ ì¸ë ¥
- í•´ë‹¹ ì›”ì˜ ìœ íš¨í•œ ê¸‰ì—¬ ì •ë³´

SQLì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
```

#### ì˜ˆìƒ SQL

```sql
WITH target_month AS (
    SELECT
        DATE '2023-09-01' AS month_start,
        DATE '2023-09-30' AS month_end
),
active_projects AS (
    SELECT
        p.project_id,
        p.project_name,
        p.start_date,
        p.end_date
    FROM projects p
    CROSS JOIN target_month tm
    WHERE p.start_date <= tm.month_end
      AND (p.end_date IS NULL OR p.end_date >= tm.month_start)
),
project_pls AS (
    SELECT DISTINCT
        pa.project_id,
        pa.emp_id
    FROM project_assignments pa
    CROSS JOIN target_month tm
    WHERE pa.role = 'PL'
      AND pa.assigned_date <= tm.month_end
      AND (pa.released_date IS NULL OR pa.released_date >= tm.month_start)
),
pl_salaries AS (
    SELECT
        emp_id,
        base_salary + (bonus / 12.0) + allowances AS monthly_salary,
        ROW_NUMBER() OVER (
            PARTITION BY emp_id
            ORDER BY effective_date DESC
        ) as rn
    FROM employee_salaries
    CROSS JOIN target_month tm
    WHERE effective_date <= tm.month_end
)
SELECT
    ap.project_name AS í”„ë¡œì íŠ¸ëª…,
    e.emp_name AS PLì´ë¦„,
    e.position AS ì§ê¸‰,
    ps.monthly_salary AS ì›”ê¸‰ì—¬,
    ap.start_date AS í”„ë¡œì íŠ¸ì‹œì‘ì¼,
    ap.end_date AS í”„ë¡œì íŠ¸ì¢…ë£Œì¼
FROM active_projects ap
INNER JOIN project_pls ppl ON ap.project_id = ppl.project_id
INNER JOIN employees e ON ppl.emp_id = e.emp_id
INNER JOIN pl_salaries ps ON e.emp_id = ps.emp_id AND ps.rn = 1
ORDER BY ap.project_name;
```

---

## ì‚¬ë¡€ 3: ê¸‰ì—¬ ë³€ë™ ì´ë ¥ ì¡°íšŒ

### ì—…ë¬´ ìš”êµ¬ì‚¬í•­

íŠ¹ì • ì§ì›ì˜ ê¸‰ì—¬ ë³€ë™ ì´ë ¥ì„ ì‹œê³„ì—´ë¡œ ì¡°íšŒí•©ë‹ˆë‹¤.

### AIì—ê²Œ ì§ˆë¬¸í•˜ê¸°

```
## ëª©í‘œ
íŠ¹ì • ì§ì›(emp_id = 1234)ì˜ ê¸‰ì—¬ ë³€ë™ ì´ë ¥ì„ ì¡°íšŒí•˜ê³ ,
ê° ë³€ë™ ì‹œ ì¦ê°ì•¡ê³¼ ì¦ê°ë¥ ì„ ê³„ì‚°í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.

## í…Œì´ë¸”
- employee_salaries: emp_id, effective_date, base_salary, bonus, allowances

## ìš”êµ¬ì‚¬í•­
- ì‹œê°„ ìˆœì„œëŒ€ë¡œ ì •ë ¬
- ì´ì „ ê¸‰ì—¬ ëŒ€ë¹„ ì¦ê°ì•¡ ê³„ì‚°
- ì¦ê°ë¥ (%) ê³„ì‚°

LAG ìœˆë„ìš° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ë  ê²ƒ ê°™ì€ë°, SQLì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
```

#### ì˜ˆìƒ SQL

```sql
WITH salary_history AS (
    SELECT
        emp_id,
        effective_date,
        base_salary,
        base_salary + (bonus / 12.0) + allowances AS total_monthly,
        LAG(base_salary + (bonus / 12.0) + allowances) OVER (
            PARTITION BY emp_id
            ORDER BY effective_date
        ) AS prev_monthly
    FROM employee_salaries
    WHERE emp_id = 1234
)
SELECT
    effective_date AS ì ìš©ì¼,
    base_salary AS ê¸°ë³¸ê¸‰,
    total_monthly AS ì›”ê¸‰ì—¬,
    prev_monthly AS ì´ì „ì›”ê¸‰ì—¬,
    total_monthly - prev_monthly AS ì¦ê°ì•¡,
    ROUND(
        ((total_monthly - prev_monthly) / NULLIF(prev_monthly, 0)) * 100,
        2
    ) AS ì¦ê°ë¥ 
FROM salary_history
ORDER BY effective_date;
```

---

## ì‹¤ìŠµ ê³¼ì œ

### ê³¼ì œ 1
ìµœê·¼ 1ë…„ê°„ ê¸‰ì—¬ê°€ ì¸ìƒëœ ì§ì› ëª©ë¡ê³¼ í‰ê·  ì¸ìƒë¥ ì„ ì¡°íšŒí•˜ì„¸ìš”.

### ê³¼ì œ 2
ë¶€ì„œë³„ í‰ê·  ê¸‰ì—¬ë¥¼ ì¡°íšŒí•˜ê³ , ì „ì‚¬ í‰ê·  ëŒ€ë¹„ ë†’ì€ì§€ ë‚®ì€ì§€ í‘œì‹œí•˜ì„¸ìš”.

### ê³¼ì œ 3
ì—°ë´‰ ìƒìœ„ 10% ì§ì›ë“¤ì˜ ë¶€ì„œë³„ ë¶„í¬ë¥¼ ì¡°íšŒí•˜ì„¸ìš”.

---

## ë‹¤ìŒ ë‹¨ê³„

ê¸‰ì—¬ ì¡°íšŒë¥¼ ìµí˜”ë‹¤ë©´, ë§ˆì§€ë§‰ìœ¼ë¡œ ì´ë¬´ ê´€ë ¨ ì¡°íšŒë„ ì—°ìŠµí•´ë´…ì‹œë‹¤!

ğŸ‘‰ **[ì´ë¬´ ì¡°íšŒ ì‚¬ë¡€ë¡œ ì´ë™](./ì´ë¬´-ì¡°íšŒ-ì‚¬ë¡€.md)**
